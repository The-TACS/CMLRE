<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Indian Marine Fishing Zone Map</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            height: 100vh;
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #2c5aa0 0%, #1e3d59 100%);
            color: white;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 1000;
            position: relative;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }

        .header h1 {
            font-size: 1.5em;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .controls {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .btn {
            background: rgba(255,255,255,0.2);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .btn:hover {
            background: rgba(255,255,255,0.3);
            transform: translateY(-1px);
        }

        #map {
            height: calc(100vh - 70px);
            width: 100%;
        }

        .legend {
            position: absolute;
            top: 90px;
            right: 20px;
            background: rgba(255,255,255,0.95);
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            z-index: 1000;
            min-width: 200px;
        }

        .legend h3 {
            color: #2c5aa0;
            margin-bottom: 15px;
            text-align: center;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }

        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 3px;
            border: 1px solid #333;
        }

        .danger-color { background: #e74c3c; }
        .safe-color { background: #27ae60; }
        .restricted-color { background: #f39c12; }

        .popup-content {
            max-width: 350px;
            min-width: 300px;
        }

        .popup-content h3 {
            color: #2c5aa0;
            margin-bottom: 10px;
            font-size: 1.2em;
        }

        .popup-content img {
            width: 100%;
            height: 150px;
            object-fit: cover;
            border-radius: 8px;
            margin-bottom: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }

        .fish-details {
            background: #f8f9fa;
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 15px;
        }

        .detail-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
        }

        .detail-label {
            font-weight: bold;
            color: #555;
        }

        .population-status {
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: bold;
        }

        .population-low {
            background: #fadbd8;
            color: #e74c3c;
        }

        .population-healthy {
            background: #d5f4e6;
            color: #27ae60;
        }

        .population-moderate {
            background: #fef9e7;
            color: #f39c12;
        }

        .zone-status {
            text-align: center;
            padding: 8px;
            border-radius: 5px;
            margin-bottom: 10px;
            font-weight: bold;
        }

        .zone-danger {
            background: #fadbd8;
            color: #e74c3c;
        }

        .zone-safe {
            background: #d5f4e6;
            color: #27ae60;
        }

        .zone-restricted {
            background: #fef9e7;
            color: #f39c12;
        }

        .action-buttons {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .popup-btn {
            flex: 1;
            padding: 10px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .btn-3d {
            background: linear-gradient(45deg, #3498db, #2980b9);
            color: white;
        }

        .btn-3d:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.4);
        }

        .btn-info {
            background: linear-gradient(45deg, #95a5a6, #7f8c8d);
            color: white;
        }

        .btn-info:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(149, 165, 166, 0.4);
        }

        .zone-info {
            position: absolute;
            bottom: 20px;
            left: 20px;
            background: rgba(255,255,255,0.95);
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            z-index: 1000;
            max-width: 300px;
        }

        .zone-stats {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }

        .stat-item {
            text-align: center;
        }

        .stat-number {
            font-size: 1.5em;
            font-weight: bold;
            color: #2c5aa0;
        }

        .stat-label {
            font-size: 0.8em;
            color: #666;
        }

        @media (max-width: 768px) {
            .header {
                flex-direction: column;
                gap: 10px;
                padding: 10px;
            }

            .controls {
                flex-wrap: wrap;
                justify-content: center;
            }

            .legend,
            .zone-info {
                position: relative;
                width: 95%;
                margin: 10px auto;
            }

            #map {
                height: calc(100vh - 120px);
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1><i class="fas fa-map-marked-alt"></i> Indian Marine Fishing Zones</h1>
        <div class="controls">
            <button class="btn" onclick="toggleZoneType('all')"><i class="fas fa-eye"></i> Show All</button>
            <button class="btn" onclick="toggleZoneType('safe')"><i class="fas fa-check"></i> Safe Only</button>
            <button class="btn" onclick="toggleZoneType('danger')"><i class="fas fa-ban"></i> Danger Only</button>
            <button class="btn" onclick="resetView()"><i class="fas fa-home"></i> Reset View</button>
        </div>
    </div>

    <div id="map"></div>

    <!-- Legend -->
    <div class="legend">
        <h3>Fishing Zone Legend</h3>
        <div class="legend-item">
            <div class="legend-color safe-color"></div>
            <span>Safe Fishing Zone</span>
        </div>
        <div class="legend-item">
            <div class="legend-color restricted-color"></div>
            <span>Restricted Fishing</span>
        </div>
        <div class="legend-item">
            <div class="legend-color danger-color"></div>
            <span>No Fishing - Danger Zone</span>
        </div>
    </div>

    <!-- Zone Information -->
    <div class="zone-info">
        <h4 style="color: #2c5aa0; margin-bottom: 10px;">Zone Statistics</h4>
        <div class="zone-stats">
            <div class="stat-item">
                <div class="stat-number" id="safeCount">0</div>
                <div class="stat-label">Safe Zones</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="dangerCount">0</div>
                <div class="stat-label">Danger Zones</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="speciesCount">0</div>
                <div class="stat-label">Species</div>
            </div>
        </div>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        // Indian Marine Fishing Zones Data
        const fishingZonesData = {
            "type": "FeatureCollection",
            "features": [
                {
                    "type": "Feature",
                    "properties": {
                        "name": "Gulf of Mannar Marine National Park",
                        "status": "danger",
                        "reason": "Critical breeding ground - Dugong sanctuary",
                        "fish": {
                            "name": "Dugong",
                            "scientificName": "Dugong dugon",
                            "population": "Critical - Only 200 individuals left",
                            "status": "low",
                            "image": "https://www.experienceandamans.com/blog/wp-content/uploads/2017/12/Dugong-Rarest-sea-cow-in-the-world-1.jpg.webp",
                            "description": "Endangered marine mammal. Critical breeding and feeding ground. Fishing activities cause habitat destruction and accidental capture.",
                            "threats": "Boat strikes, fishing nets, habitat loss",
                            "conservation": "Strictly Protected under Wildlife Protection Act",
                            "link":"Dugong.html"
                        }
                    },
                    "geometry": {
                        "type": "Polygon",
                        "coordinates": [[[78.8, 9.0], [79.3, 9.0], [79.3, 9.3], [78.8, 9.3], [78.8, 9.0]]]
                    }
                },
                {
                    "type": "Feature", 
                    "properties": {
                        "name": "Sundarbans Marine Reserve",
                        "status": "danger",
                        "reason": "Tiger Shrimp breeding area - Population declining",
                        "fish": {
                            "name": "Tiger Shrimp",
                            "scientificName": "Penaeus monodon", 
                            "population": "Declining - 60% reduction in 5 years",
                            "status": "low",
                            "image": "https://upload.wikimedia.org/wikipedia/commons/thumb/2/2e/CSIRO_ScienceImage_2992_The_Giant_Tiger_Prawn.jpg/1280px-CSIRO_ScienceImage_2992_The_Giant_Tiger_Prawn.jpg",
                            "description": "Primary breeding ground for Tiger Shrimp. Overfishing has caused severe population decline. Critical for ecosystem balance.",
                            "threats": "Overfishing, pollution, mangrove destruction", 
                            "conservation": "Breeding season closure: June-September",
                            "link":"Tiger Shrimp.html"
                        }
                    },
                    "geometry": {
                        "type": "Polygon",
                        "coordinates": [[[88.0, 21.5], [89.0, 21.5], [89.0, 22.2], [88.0, 22.2], [88.0, 21.5]]]
                    }
                },
                {
                    "type": "Feature",
                    "properties": {
                        "name": "Coral Gardens Reserve - Lakshadweep",
                        "status": "danger", 
                        "reason": "Coral reef ecosystem - Fish spawning ground",
                        "fish": {
                            "name": "Parrotfish",
                            "scientificName": "Scarus ghobban",
                            "population": "Critically low - Coral dependent",
                            "status": "low",
                            "image": "https://www.scuba.com/blog/wp-content/uploads/2011/11/parrotfish-AdobeStock_386630558.jpg",
                            "description": "Essential for coral reef health. Population crashed due to coral bleaching and fishing pressure. Key species for reef ecosystem.",
                            "threats": "Coral bleaching, destructive fishing, tourism",
                            "conservation": "Total fishing ban - Reef restoration zone",
                            "link":"parrotfish.html"
                        }
                    },
                    "geometry": {
                        "type": "Polygon", 
                        "coordinates": [[[72.0, 10.0], [73.5, 10.0], [73.5, 12.0], [72.0, 12.0], [72.0, 10.0]]]
                    }
                },
                {
                    "type": "Feature",
                    "properties": {
                        "name": "Karnataka Coast - Sardine Zone",
                        "status": "safe",
                        "reason": "Healthy sardine population - Sustainable fishing allowed",
                        "fish": {
                            "name": "Indian Oil Sardine",
                            "scientificName": "Sardinella longiceps",
                            "population": "Healthy - Stable population trends", 
                            "status": "healthy",
                            "image": "https://static.wixstatic.com/media/42a449_5b4a5fe4da5740519aa5a7344dc65a9a~mv2.png/v1/fill/w_500,h_500,al_c/Indian%20Oil%20Sardine.png",
                            "description": "Abundant population with sustainable fishing practices. Peak season October to March. Important commercial species supporting local livelihoods.",
                            "threats": "Minimal - Well managed fishery",
                            "conservation": "Sustainable quota system in place",
                            "link":"Indian Oil Sardine.html"
                        }
                    },
                    "geometry": {
                        "type": "Polygon",
                        "coordinates": [[[74.0, 12.5], [75.5, 12.5], [75.5, 15.0], [74.0, 15.0], [74.0, 12.5]]]
                    }
                },
                {
                    "type": "Feature",
                    "properties": {
                        "name": "Gujarat Commercial Fishing Zone",
                        "status": "safe",
                        "reason": "Well-managed multi-species fishery",
                        "fish": {
                            "name": "Pomfret", 
                            "scientificName": "Pampus argenteus",
                            "population": "Stable - Good management practices",
                            "status": "healthy",
                            "image": "https://upload.wikimedia.org/wikipedia/commons/6/66/Pampus_argenteus_1.jpg",
                            "description": "Well-managed commercial fishery with sustainable catches. High-value species with strong market demand. Fishing cooperatives ensure responsible practices.",
                            "threats": "Low - Active management",
                            "conservation": "Fishing license system with quotas",
                            "link":"pomfret.html"
                        }
                    },
                    "geometry": {
                        "type": "Polygon", 
                        "coordinates": [[[68.5, 20.0], [72.0, 20.0], [72.0, 23.5], [68.5, 23.5], [68.5, 20.0]]]
                    }
                },
                {
                    "type": "Feature",
                    "properties": {
                        "name": "Tamil Nadu - Tuna Fishing Zone",
                        "status": "restricted",
                        "reason": "Seasonal restrictions - Tuna migration route", 
                        "fish": {
                            "name": "Yellowfin Tuna",
                            "scientificName": "Thunnus albacares",
                            "population": "Moderate - Requires careful management",
                            "status": "moderate",
                            "image": "https://upload.wikimedia.org/wikipedia/commons/c/c3/Thunnus_albacares.png", 
                            "description": "Important migration corridor for tuna. Fishing allowed outside breeding season with special permits. High-value commercial species requiring international coordination.",
                            "threats": "Overfishing by large vessels",
                            "conservation": "Seasonal closure April-June, License required",
                            "link":"Yellowfin.html"
                        }
                    },
                    "geometry": {
                        "type": "Polygon",
                        "coordinates": [[[78.5, 8.0], [81.0, 8.0], [81.0, 13.0], [78.5, 13.0], [78.5, 8.0]]]
                    }
                },
                {
                    "type": "Feature",
                    "properties": {
                        "name": "Konkan Coast Mackerel Zone",
                        "status": "safe", 
                        "reason": "Abundant mackerel stocks - Traditional fishing area",
                        "fish": {
                            "name": "Indian Mackerel",
                            "scientificName": "Rastrelliger kanagurta", 
                            "population": "Abundant - Traditional fishing sustainable",
                            "status": "healthy",
                            "image": "https://upload.wikimedia.org/wikipedia/commons/4/41/Rastrelliger_kanagurta_JNC2855.JPG",
                            "description": "Traditional fishing grounds with sustainable practices. Seasonal abundance patterns well understood by local fishermen. Important for food security and livelihoods.",
                            "threats": "Minimal with traditional methods", 
                            "conservation": "Community-based management",
                            "link":"mackerel.html"
                        }
                    },
                    "geometry": {
                        "type": "Polygon",
                        "coordinates": [[[72.5, 15.0], [74.5, 15.0], [74.5, 18.0], [72.5, 18.0], [72.5, 15.0]]]
                    }
                }
            ]
        };

        // Initialize map
        let map = L.map('map').setView([15.0, 76.0], 6);

        // Add tile layer
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            maxZoom: 18,
            attribution: '© OpenStreetMap contributors'
        }).addTo(map);

        // Zone layers
        let allZones = L.layerGroup().addTo(map);
        let safeZones = L.layerGroup();  
        let dangerZones = L.layerGroup();

        // Zone styling
        const zoneStyles = {
            safe: {
                color: '#27ae60',
                fillColor: '#27ae60', 
                fillOpacity: 0.4,
                weight: 3,
                dashArray: '5, 5'
            },
            danger: {
                color: '#e74c3c',
                fillColor: '#e74c3c',
                fillOpacity: 0.4, 
                weight: 3,
                dashArray: '10, 5'
            },
            restricted: {
                color: '#f39c12',
                fillColor: '#f39c12',
                fillOpacity: 0.4,
                weight: 3,
                dashArray: '15, 10, 5, 10'
            }
        };

        // Create popup content
        function createPopupContent(feature) {
            const props = feature.properties;
            const fish = props.fish;
            
            const statusClass = `zone-${props.status}`;
            const populationClass = `population-${fish.status}`;
            
            return `
                <div class="popup-content">
                    <h3><i class="fas fa-map-pin"></i> ${props.name}</h3>
                    
                    <div class="zone-status ${statusClass}">
                        ${props.status === 'safe' ? '✅ FISHING ALLOWED' : 
                          props.status === 'restricted' ? '⚠️ RESTRICTED FISHING' : 
                          '🚫 NO FISHING ZONE'}
                    </div>
                    
                    <img src="${fish.image}" alt="${fish.name}" onerror="this.src='https://via.placeholder.com/300x150/3498db/white?text=Marine+Species'">
                    
                    <div class="fish-details">
                        <div class="detail-row">
                            <span class="detail-label">Species:</span>
                            <span>${fish.name}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Scientific:</span>
                            <span><em>${fish.scientificName}</em></span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Population:</span>
                            <span class="population-status ${populationClass}">${fish.status.toUpperCase()}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Status:</span>
                            <span>${fish.population}</span>
                        </div>
                    </div>
                    
                    <p><strong>Description:</strong> ${fish.description}</p>
                    
                    <p><strong>Conservation:</strong> ${fish.conservation}</p>
                    
                    <p><strong>Reason:</strong> ${props.reason}</p>
                    
                    <div class="action-buttons">
                        <button class="popup-btn btn-3d" onclick="window.location.href='${fish.link}'">
                            <i class="fas fa-cube"></i> View in 3D
                        </button>

                        <button class="popup-btn btn-info">
                            <a href="https://indobis.in/" target="_blank" style="color: white; text-decoration: none;">
                            <i class="fas fa-info-circle"></i> More Info  </a>
                        </button>
                    </div>
                </div>
            `;
        }

        // Add zones to map
        function addZonesToMap() {
            let safeCount = 0;
            let dangerCount = 0;
            let speciesCount = 0;

            fishingZonesData.features.forEach(feature => {
                const props = feature.properties;
                const style = zoneStyles[props.status] || zoneStyles.safe;
                
                const layer = L.geoJSON(feature, {
                    style: style,
                    onEachFeature: function(feature, layer) {
                        layer.bindPopup(createPopupContent(feature), {
                            maxWidth: 400,
                            className: 'custom-popup'
                        });
                        
                        // Add hover effects
                        layer.on('mouseover', function() {
                            this.setStyle({
                                weight: 5,
                                fillOpacity: 0.6
                            });
                        });
                        
                        layer.on('mouseout', function() {
                            this.setStyle(style);
                        });
                    }
                });
                
                allZones.addLayer(layer);
                
                if (props.status === 'safe') {
                    safeZones.addLayer(layer);
                    safeCount++;
                } else if (props.status === 'danger') {
                    dangerZones.addLayer(layer); 
                    dangerCount++;
                }
                
                speciesCount++;
            });

            // Update statistics
            document.getElementById('safeCount').textContent = safeCount;
            document.getElementById('dangerCount').textContent = dangerCount;
            document.getElementById('speciesCount').textContent = speciesCount;
        }

        // Zone toggle functions
        function toggleZoneType(type) {
            map.eachLayer(layer => {
                if (layer !== map._layers[Object.keys(map._layers)[0]]) { // Keep base tile layer
                    map.removeLayer(layer);
                }
            });

            switch(type) {
                case 'safe':
                    map.addLayer(safeZones);
                    break;
                case 'danger': 
                    map.addLayer(dangerZones);
                    break;
                default:
                    map.addLayer(allZones);
            }
        }

        function resetView() {
            map.setView([15.0, 76.0], 6);
        }

        // 3D Model viewer function
        function view3DModel(fishName, scientificName) {
            const decodedName = decodeURIComponent(fishName);
            const decodedScientific = decodeURIComponent(scientificName);
            
            alert(`🐟 Opening 3D model viewer for:\n\n${decodedName}\n(${decodedScientific})\n\nThis will redirect to your 3D fish viewer page.`);
            
            // In your actual implementation, redirect to 3D viewer:
            // const fishKey = decodedName.toLowerCase().replace(/\s+/g, '_');
            // window.location.href = `3d-viewer/fish-viewer.html?fish=${fishKey}&name=${encodeURIComponent(decodedName)}`;
        }

        function showMoreInfo(zoneName) {
            const decodedZone = decodeURIComponent(zoneName);
            alert(`📊 Detailed information for:\n\n${decodedZone}\n\nThis would show:\n• Historical fishing data\n• Population trends\n• Regulatory details\n• Seasonal patterns\n• Research studies`);
        }

        // Initialize everything
        document.addEventListener('DOMContentLoaded', function() {
            addZonesToMap();
            
            // Add custom CSS for popup
            const style = document.createElement('style');
            style.textContent = `
                .leaflet-popup-content-wrapper {
                    border-radius: 12px;
                    box-shadow: 0 10px 30px rgba(0,0,0,0.3);
                }
                .leaflet-popup-tip {
                    box-shadow: 0 2px 10px rgba(0,0,0,0.2);
                }
            `;
            document.head.appendChild(style);
        });
    </script>
</body>
</html>
